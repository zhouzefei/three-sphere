!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("three"),require("@tntv/layers")):"function"==typeof define&&define.amd?define(["three","@tntv/layers"],t):"object"==typeof exports?exports.ThreeSphere=t(require("three"),require("@tntv/layers")):e.ThreeSphere=t(e.three,e["@tntv/layers"])}(window,(function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(t,n){t.exports=e},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,n){e.exports=t},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=27)}([function(e,t,n){(function(t){var n=function(e){return e&&e.Math==Math&&e};e.exports=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")()}).call(this,n(31))},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(1);e.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){var r=n(3),o=n(15),i=n(9);e.exports=r?function(e,t,n){return o.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(10),o=n(12);e.exports=function(e){return r(o(e))}},function(e,t,n){var r=n(0),o=n(5);e.exports=function(e,t){try{o(r,e,t)}catch(n){r[e]=t}return t}},function(e,t,n){var r=n(3),o=n(32),i=n(9),a=n(6),s=n(13),c=n(2),u=n(14),l=Object.getOwnPropertyDescriptor;t.f=r?l:function(e,t){if(e=a(e),t=s(t,!0),u)try{return l(e,t)}catch(e){}if(c(e,t))return i(!o.f.call(e,t),e[t])}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,n){var r=n(1),o=n(11),i="".split;e.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==o(e)?i.call(e,""):Object(e)}:Object},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){var r=n(3),o=n(1),i=n(33);e.exports=!r&&!o((function(){return 7!=Object.defineProperty(i("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(3),o=n(14),i=n(16),a=n(13),s=Object.defineProperty;t.f=r?s:function(e,t,n){if(i(e),t=a(t,!0),i(n),o)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(4);e.exports=function(e){if(!r(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){var r=n(18),o=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(e){return o.call(e)}),e.exports=r.inspectSource},function(e,t,n){var r=n(0),o=n(7),i=r["__core-js_shared__"]||o("__core-js_shared__",{});e.exports=i},function(e,t,n){var r=n(38),o=n(18);(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++n+r).toString(36)}},function(e,t){e.exports={}},function(e,t,n){var r=n(41),o=n(0),i=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?i(r[e])||i(o[e]):r[e]&&r[e][t]||o[e]&&o[e][t]}},function(e,t,n){var r=n(24),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(0),o=n(19),i=n(2),a=n(20),s=n(26),c=n(55),u=o("wks"),l=r.Symbol,h=c?l:l&&l.withoutSetter||a;e.exports=function(e){return i(u,e)||(s&&i(l,e)?u[e]=l[e]:u[e]=h("Symbol."+e)),u[e]}},function(e,t,n){var r=n(1);e.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(e,t,n){"use strict";var r=n(28);n(29),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n(60)),i=r(n(61)),a={decoder:i.default,encoder:o.default,encode:function(e){var t=JSON.parse(JSON.stringify(e));return this.encodeFeatures(t)},encodeFeatures:function(e){var t=this;if("Feature"===e.type)return this.encodeFeature(e);if("FeatureCollection"===e.type){var n=e.features.map((function(e){return t.encodeFeatures(e)}));return e.features=n,e}return this.encodeFeature(e)},encodeFeature:function(e){var t=e.geometry.coordinates,n=t;switch(e.geometry.type){case"Point":break;case"LineString":case"MultiPoint":n=Array.isArray(t[0])?[o.default.encode(t)]:t;break;case"MultiLineString":case"Polygon":n=Array.isArray(t[0][0])?t.map((function(e){return o.default.encode(e)})):t;break;case"MultiPolygon":n=Array.isArray(t[0][0][0])?t.map((function(e){return e.map((function(e){return o.default.encode(e)}))})):t}return e.geometry.coordinates=n,e},decode:function(e){var t=JSON.parse(JSON.stringify(e));return this.decodeFeatures(t)},decodeFeatures:function(e){var t=this;if("Feature"===e.type)return this.decodeFeature(e);if("FeatureCollection"===e.type){var n=e.features.map((function(e){return t.decodeFeatures(e)}));return e.features=n,e}return this.decodeFeature(e)},decodeFeature:function(e){var t=e.geometry.coordinates,n=t;switch(e.geometry.type){case"Point":break;case"LineString":case"MultiPoint":n=Array.isArray(t[0])?t:i.default.decode(t[0]);break;case"MultiLineString":case"Polygon":n=Array.isArray(t[0][0])?t:t.map((function(e){return i.default.decode(e)}));break;case"MultiPolygon":n=Array.isArray(t[0][0][0])?t:t.map((function(e){return e.map((function(e){return i.default.decode(e)}))}))}return e.geometry.coordinates=n,e}};t.default=a},function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},function(e,t,n){"use strict";var r=n(30),o=n(49).map,i=n(56),a=n(59),s=i("map"),c=a("map");r({target:"Array",proto:!0,forced:!s||!c},{map:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0),o=n(8).f,i=n(5),a=n(34),s=n(7),c=n(39),u=n(48);e.exports=function(e,t){var n,l,h,f,p,d=e.target,v=e.global,m=e.stat;if(n=v?r:m?r[d]||s(d,{}):(r[d]||{}).prototype)for(l in t){if(f=t[l],h=e.noTargetGet?(p=o(n,l))&&p.value:n[l],!u(v?l:d+(m?".":"#")+l,e.forced)&&void 0!==h){if(typeof f==typeof h)continue;c(f,h)}(e.sham||h&&h.sham)&&i(f,"sham",!0),a(n,l,f,e)}}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";var r={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,i=o&&!r.call({1:2},1);t.f=i?function(e){var t=o(this,e);return!!t&&t.enumerable}:r},function(e,t,n){var r=n(0),o=n(4),i=r.document,a=o(i)&&o(i.createElement);e.exports=function(e){return a?i.createElement(e):{}}},function(e,t,n){var r=n(0),o=n(5),i=n(2),a=n(7),s=n(17),c=n(35),u=c.get,l=c.enforce,h=String(String).split("String");(e.exports=function(e,t,n,s){var c=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,f=!!s&&!!s.noTargetGet;"function"==typeof n&&("string"!=typeof t||i(n,"name")||o(n,"name",t),l(n).source=h.join("string"==typeof t?t:"")),e!==r?(c?!f&&e[t]&&(u=!0):delete e[t],u?e[t]=n:o(e,t,n)):u?e[t]=n:a(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||s(this)}))},function(e,t,n){var r,o,i,a=n(36),s=n(0),c=n(4),u=n(5),l=n(2),h=n(37),f=n(21),p=s.WeakMap;if(a){var d=new p,v=d.get,m=d.has,y=d.set;r=function(e,t){return y.call(d,e,t),t},o=function(e){return v.call(d,e)||{}},i=function(e){return m.call(d,e)}}else{var g=h("state");f[g]=!0,r=function(e,t){return u(e,g,t),t},o=function(e){return l(e,g)?e[g]:{}},i=function(e){return l(e,g)}}e.exports={set:r,get:o,has:i,enforce:function(e){return i(e)?o(e):r(e,{})},getterFor:function(e){return function(t){var n;if(!c(t)||(n=o(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},function(e,t,n){var r=n(0),o=n(17),i=r.WeakMap;e.exports="function"==typeof i&&/native code/.test(o(i))},function(e,t,n){var r=n(19),o=n(20),i=r("keys");e.exports=function(e){return i[e]||(i[e]=o(e))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(2),o=n(40),i=n(8),a=n(15);e.exports=function(e,t){for(var n=o(t),s=a.f,c=i.f,u=0;u<n.length;u++){var l=n[u];r(e,l)||s(e,l,c(t,l))}}},function(e,t,n){var r=n(22),o=n(42),i=n(47),a=n(16);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(a(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(0);e.exports=r},function(e,t,n){var r=n(43),o=n(46).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,o)}},function(e,t,n){var r=n(2),o=n(6),i=n(44).indexOf,a=n(21);e.exports=function(e,t){var n,s=o(e),c=0,u=[];for(n in s)!r(a,n)&&r(s,n)&&u.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~i(u,n)||u.push(n));return u}},function(e,t,n){var r=n(6),o=n(23),i=n(45),a=function(e){return function(t,n,a){var s,c=r(t),u=o(c.length),l=i(a,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},function(e,t,n){var r=n(24),o=Math.max,i=Math.min;e.exports=function(e,t){var n=r(e);return n<0?o(n+t,0):i(n,t)}},function(e,t){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(1),o=/#|\.prototype\./,i=function(e,t){var n=s[a(e)];return n==u||n!=c&&("function"==typeof t?r(t):!!t)},a=i.normalize=function(e){return String(e).replace(o,".").toLowerCase()},s=i.data={},c=i.NATIVE="N",u=i.POLYFILL="P";e.exports=i},function(e,t,n){var r=n(50),o=n(10),i=n(52),a=n(23),s=n(53),c=[].push,u=function(e){var t=1==e,n=2==e,u=3==e,l=4==e,h=6==e,f=5==e||h;return function(p,d,v,m){for(var y,g,b=i(p),w=o(b),x=r(d,v,3),S=a(w.length),O=0,E=m||s,M=t?E(p,S):n?E(p,0):void 0;S>O;O++)if((f||O in w)&&(g=x(y=w[O],O,b),e))if(t)M[O]=g;else if(g)switch(e){case 3:return!0;case 5:return y;case 6:return O;case 2:c.call(M,y)}else if(l)return!1;return h?-1:u||l?l:M}};e.exports={forEach:u(0),map:u(1),filter:u(2),some:u(3),every:u(4),find:u(5),findIndex:u(6)}},function(e,t,n){var r=n(51);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var r=n(12);e.exports=function(e){return Object(r(e))}},function(e,t,n){var r=n(4),o=n(54),i=n(25)("species");e.exports=function(e,t){var n;return o(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!o(n.prototype)?r(n)&&null===(n=n[i])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)}},function(e,t,n){var r=n(11);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(26);e.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,n){var r=n(1),o=n(25),i=n(57),a=o("species");e.exports=function(e){return i>=51||!r((function(){var t=[];return(t.constructor={})[a]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},function(e,t,n){var r,o,i=n(0),a=n(58),s=i.process,c=s&&s.versions,u=c&&c.v8;u?o=(r=u.split("."))[0]+r[1]:a&&(!(r=a.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=a.match(/Chrome\/(\d+)/))&&(o=r[1]),e.exports=o&&+o},function(e,t,n){var r=n(22);e.exports=r("navigator","userAgent")||""},function(e,t,n){var r=n(3),o=n(1),i=n(2),a=Object.defineProperty,s={},c=function(e){throw e};e.exports=function(e,t){if(i(s,e))return s[e];t||(t={});var n=[][e],u=!!i(t,"ACCESSORS")&&t.ACCESSORS,l=i(t,0)?t[0]:c,h=i(t,1)?t[1]:void 0;return s[e]=!!n&&!o((function(){if(u&&!r)return!0;var e={length:-1};u?a(e,1,{enumerable:!0,get:c}):e[1]=1,n.call(e,l,h)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={options:{precision:5,factor:Math.pow(10,5),dimension:2},encode:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options,n=[],r=0,o=e.length;r<o;++r){var i=e[r];if(2===t.dimension)n.push(i.lat||i[0]),n.push(i.lng||i[1]);else for(var a=0;a<t.dimension;++a)n.push(i[a])}return this.encodeDeltas(n,t)},encodeDeltas:function(e,t){for(var n=[],r=0,o=e.length;r<o;)for(var i=0;i<t.dimension;++i,++r){var a=e[r],s=a-(n[i]||0);n[i]=a,e[r]=s}return this.encodeFloats(e,t)},encodeFloats:function(e,t){for(var n=0,r=e.length;n<r;++n)e[n]=Math.round(e[n]*t.factor);return this.encodeSignedIntegers(e)},encodeSignedIntegers:function(e){for(var t=0,n=e.length;t<n;++t){var r=e[t];e[t]=r<0?~(r<<1):r<<1}return this.encodeUnsignedIntegers(e)},encodeUnsignedIntegers:function(e){for(var t="",n=0,r=e.length;n<r;++n)t+=this.encodeUnsignedInteger(e[n]);return t},encodeSignedInteger:function(e){return e=e<0?~(e<<1):e<<1,this.encodeUnsignedInteger(e)},encodeUnsignedInteger:function(e){for(var t,n="";e>=32;)t=63+(32|31&e),n+=String.fromCharCode(t),e>>=5;return t=e+63,n+=String.fromCharCode(t)}};t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r={options:{precision:5,factor:Math.pow(10,5),dimension:2},decode:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.options,n=this.decodeDeltas(e,t),r=[],o=0,i=n.length;o+(t.dimension-1)<i;){for(var a=[],s=0;s<t.dimension;++s)a.push(n[o++]);r.push(a)}return r},decodeDeltas:function(e,t){for(var n=this.decodeFloats(e,t),r=[],o=0,i=n.length;o<i;)for(var a=0;a<t.dimension;++a,++o)n[o]=Math.round((r[a]=n[o]+(r[a]||0))*t.factor)/t.factor;return n},decodeFloats:function(e,t){for(var n=this.decodeSignedIntegers(e),r=0,o=n.length;r<o;++r)n[r]/=t.factor;return n},decodeSignedIntegers:function(e){for(var t=this.decodeUnsignedIntegers(e),n=0,r=t.length;n<r;++n)t[n]=1&t[n]?~(t[n]>>1):t[n]>>1;return t},decodeUnsignedIntegers:function(e){for(var t=[],n=0,r=0,o=0,i=e.length;o<i;++o){var a=e.charCodeAt(o)-63;n|=(31&a)<<r,a<32?(t.push(n),n=0,r=0):r+=5}return t}};t.default=r}]).default},e.exports=r()},function(e,t,n){var r=n(10),o=n(11),i=n(5),a=n(12);e.exports=function(e){return r(e)||o(e)||i(e)||a()}},function(e,t,n){var r=n(13),o=n(14),i=n(5),a=n(15);e.exports=function(e,t){return r(e)||o(e,t)||i(e,t)||a()}},function(e,t,n){var r=n(4);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){"use strict";n.r(t),n.d(t,"lglt2xyz",(function(){return d})),n.d(t,"Draw",(function(){return y})),n.d(t,"Point",(function(){return E})),n.d(t,"default",(function(){return A}));var r=n(6),o=n.n(r),i=n(1),a=n.n(i),s=n(2),c=n.n(s),u=n(7),l=n.n(u),h=n(0),f=n(3),p=function(e,t){var n,r,o,i,a;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new h.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:h.MOUSE.LEFT,ZOOM:h.MOUSE.MIDDLE,PAN:h.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.seek=function(){},this.on=function(e,t){"seek"===e&&(this.seek=t)},this.getPolarAngle=function(){return v.phi},this.getAzimuthalAngle=function(){return v.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),s.seek(),p=f.NONE},this.update=(n=new h.Vector3,r=(new h.Quaternion).setFromUnitVectors(e.up,new h.Vector3(0,1,0)),o=r.clone().inverse(),i=new h.Vector3,a=new h.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(r),v.setFromVector3(n),s.autoRotate&&p===f.NONE&&k(2*Math.PI/60/60*s.autoRotateSpeed),v.theta+=m.theta,v.phi+=m.phi,v.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,v.theta)),v.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,v.phi)),v.makeSafe(),v.radius*=y,v.radius=Math.max(s.minDistance,Math.min(s.maxDistance,v.radius)),s.target.add(g),n.setFromSpherical(v),n.applyQuaternion(o),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(m.theta*=1-s.dampingFactor,m.phi*=1-s.dampingFactor):m.set(0,0,0),y=1,g.set(0,0,0),!!(b||i.distanceToSquared(s.object.position)>d||8*(1-a.dot(s.object.quaternion))>d)&&(s.dispatchEvent(c),i.copy(s.object.position),a.copy(s.object.quaternion),b=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",Z,!1),s.domElement.removeEventListener("mousedown",F,!1),s.domElement.removeEventListener("wheel",D,!1),s.domElement.removeEventListener("touchstart",H,!1),s.domElement.removeEventListener("touchend",W,!1),s.domElement.removeEventListener("touchmove",Y,!1),document.removeEventListener("mousemove",U,!1),document.removeEventListener("mouseup",V,!1),window.removeEventListener("keydown",z,!1)};var s=this,c={type:"change"},u={type:"start"},l={type:"end"},f={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},p=f.NONE,d=1e-6,v=new h.Spherical,m=new h.Spherical,y=1,g=new h.Vector3,b=!1,w=new h.Vector2,x=new h.Vector2,S=new h.Vector2,O=new h.Vector2,E=new h.Vector2,M=new h.Vector2,j=new h.Vector2,P=new h.Vector2,C=new h.Vector2;function A(){return Math.pow(.95,s.zoomSpeed)}function k(e){m.theta-=e}function _(e){m.phi-=e}var T,L=(T=new h.Vector3,function(e,t){T.setFromMatrixColumn(t,0),T.multiplyScalar(-e),g.add(T)}),N=function(){var e=new h.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),g.add(e)}}(),G=function(){var e=new h.Vector3;return function(t,n){var r=s.domElement===document?s.domElement.body:s.domElement;if(s.object instanceof h.PerspectiveCamera){var o=s.object.position;e.copy(o).sub(s.target);var i=e.length();i*=Math.tan(s.object.fov/2*Math.PI/180),L(2*t*i/r.clientHeight,s.object.matrix),N(2*n*i/r.clientHeight,s.object.matrix)}else s.object instanceof h.OrthographicCamera?(L(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),N(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function I(e){s.object instanceof h.PerspectiveCamera?y/=e:s.object instanceof h.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function R(e){s.object instanceof h.PerspectiveCamera?y*=e:s.object instanceof h.OrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function F(e){if(!1!==s.enabled){switch(e.preventDefault(),e.button){case s.mouseButtons.ORBIT:if(!1===s.enableRotate)return;!function(e){w.set(e.clientX,e.clientY)}(e),p=f.ROTATE;break;case s.mouseButtons.ZOOM:if(!1===s.enableZoom)return;!function(e){j.set(e.clientX,e.clientY)}(e),p=f.DOLLY;break;case s.mouseButtons.PAN:if(!1===s.enablePan)return;!function(e){O.set(e.clientX,e.clientY)}(e),p=f.PAN}p!==f.NONE&&(document.addEventListener("mousemove",U,!1),document.addEventListener("mouseup",V,!1),s.dispatchEvent(u))}}function U(e){if(!1!==s.enabled)switch(e.preventDefault(),p){case f.ROTATE:if(!1===s.enableRotate)return;!function(e){x.set(e.clientX,e.clientY),S.subVectors(x,w);var t=s.domElement===document?s.domElement.body:s.domElement;k(2*Math.PI*S.x/t.clientWidth*s.rotateSpeed),_(2*Math.PI*S.y/t.clientHeight*s.rotateSpeed),w.copy(x),s.update(),s.seek()}(e);break;case f.DOLLY:if(!1===s.enableZoom)return;!function(e){P.set(e.clientX,e.clientY),C.subVectors(P,j),C.y>0?I(A()):C.y<0&&R(A()),j.copy(P),s.update(),s.seek()}(e);break;case f.PAN:if(!1===s.enablePan)return;!function(e){E.set(e.clientX,e.clientY),M.subVectors(E,O),G(M.x,M.y),O.copy(E),s.update(),s.seek()}(e)}}function V(e){!1!==s.enabled&&(document.removeEventListener("mousemove",U,!1),document.removeEventListener("mouseup",V,!1),s.dispatchEvent(l),p=f.NONE)}function D(e){!1===s.enabled||!1===s.enableZoom||p!==f.NONE&&p!==f.ROTATE||(e.preventDefault(),e.stopPropagation(),function(e){e.deltaY<0?R(A()):e.deltaY>0&&I(A()),s.update(),s.seek()}(e),s.dispatchEvent(u),s.dispatchEvent(l))}function z(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){switch(e.keyCode){case s.keys.UP:G(0,s.keyPanSpeed),s.update(),s.seek();break;case s.keys.BOTTOM:G(0,-s.keyPanSpeed),s.update(),s.seek();break;case s.keys.LEFT:G(s.keyPanSpeed,0),s.update(),s.seek();break;case s.keys.RIGHT:G(-s.keyPanSpeed,0),s.update(),s.seek()}}(e)}function H(e){if(!1!==s.enabled){switch(e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){w.set(e.touches[0].pageX,e.touches[0].pageY)}(e),p=f.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);j.set(0,r)}(e),p=f.TOUCH_DOLLY;break;case 3:if(!1===s.enablePan)return;!function(e){O.set(e.touches[0].pageX,e.touches[0].pageY)}(e),p=f.TOUCH_PAN;break;default:p=f.NONE}p!==f.NONE&&s.dispatchEvent(u)}}function Y(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(p!==f.TOUCH_ROTATE)return;!function(e){x.set(e.touches[0].pageX,e.touches[0].pageY),S.subVectors(x,w);var t=s.domElement===document?s.domElement.body:s.domElement;k(2*Math.PI*S.x/t.clientWidth*s.rotateSpeed),_(2*Math.PI*S.y/t.clientHeight*s.rotateSpeed),w.copy(x),s.update(),s.seek()}(e);break;case 2:if(!1===s.enableZoom)return;if(p!==f.TOUCH_DOLLY)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);P.set(0,r),C.subVectors(P,j),C.y>0?R(A()):C.y<0&&I(A()),j.copy(P),s.update(),s.seek()}(e);break;case 3:if(!1===s.enablePan)return;if(p!==f.TOUCH_PAN)return;!function(e){E.set(e.touches[0].pageX,e.touches[0].pageY),M.subVectors(E,O),G(M.x,M.y),O.copy(E),s.update(),s.seek()}(e);break;default:p=f.NONE}}function W(e){!1!==s.enabled&&(s.dispatchEvent(l),p=f.NONE)}function Z(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",Z,!1),s.domElement.addEventListener("mousedown",F,!1),s.domElement.addEventListener("wheel",D,{passive:!1}),s.domElement.addEventListener("touchstart",H,!1),s.domElement.addEventListener("touchend",W,!1),s.domElement.addEventListener("touchmove",Y,{passive:!1}),window.addEventListener("keydown",z,!1),this.update(),this.seek()};(p.prototype=Object.create(h.EventDispatcher.prototype)).constructor=p,Object.defineProperties(p.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var d=function(e,t,n){var r=(180+e)*(Math.PI/180),o=(90-t)*(Math.PI/180),i=-n*Math.sin(o)*Math.cos(r),a=n*Math.cos(o),s=n*Math.sin(o)*Math.sin(r);return new h.Vector3(i,a,s)},v=function(e){this.maxEdgeLength=e};v.prototype.modify=function(e){for(var t,n=[],r=[],o=this.maxEdgeLength*this.maxEdgeLength,i=0,a=e.faceVertexUvs.length;i<a;i++)r[i]=[];for(i=0,a=e.faces.length;i<a;i++){var s=e.faces[i];if(s instanceof h.Face3){var c=s.a,u=s.b,l=s.c,f=e.vertices[c],p=e.vertices[u],d=e.vertices[l],v=f.distanceToSquared(p),m=p.distanceToSquared(d),y=f.distanceToSquared(d);if(v>o||m>o||y>o){var g=e.vertices.length,b=s.clone(),w=s.clone();if(v>=m&&v>=y){if((x=f.clone()).lerp(p,.5),b.a=c,b.b=g,b.c=l,w.a=g,w.b=u,w.c=l,3===s.vertexNormals.length)(S=s.vertexNormals[0].clone()).lerp(s.vertexNormals[1],.5),b.vertexNormals[1].copy(S),w.vertexNormals[0].copy(S);if(3===s.vertexColors.length)(O=s.vertexColors[0].clone()).lerp(s.vertexColors[1],.5),b.vertexColors[1].copy(O),w.vertexColors[0].copy(O);t=0}else if(m>=v&&m>=y){if((x=p.clone()).lerp(d,.5),b.a=c,b.b=u,b.c=g,w.a=g,w.b=l,w.c=c,3===s.vertexNormals.length)(S=s.vertexNormals[1].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(S),w.vertexNormals[0].copy(S),w.vertexNormals[1].copy(s.vertexNormals[2]),w.vertexNormals[2].copy(s.vertexNormals[0]);if(3===s.vertexColors.length)(O=s.vertexColors[1].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(O),w.vertexColors[0].copy(O),w.vertexColors[1].copy(s.vertexColors[2]),w.vertexColors[2].copy(s.vertexColors[0]);t=1}else{var x,S,O;if((x=f.clone()).lerp(d,.5),b.a=c,b.b=u,b.c=g,w.a=g,w.b=u,w.c=l,3===s.vertexNormals.length)(S=s.vertexNormals[0].clone()).lerp(s.vertexNormals[2],.5),b.vertexNormals[2].copy(S),w.vertexNormals[0].copy(S);if(3===s.vertexColors.length)(O=s.vertexColors[0].clone()).lerp(s.vertexColors[2],.5),b.vertexColors[2].copy(O),w.vertexColors[0].copy(O);t=2}n.push(b,w),e.vertices.push(x);for(var E=0,M=e.faceVertexUvs.length;E<M;E++)if(e.faceVertexUvs[E].length){var j=e.faceVertexUvs[E][i],P=j[0],C=j[1],A=j[2];if(0===t){(T=P.clone()).lerp(C,.5);var k=[P.clone(),T.clone(),A.clone()],_=[T.clone(),C.clone(),A.clone()]}else if(1===t){(T=C.clone()).lerp(A,.5);k=[P.clone(),C.clone(),T.clone()],_=[T.clone(),A.clone(),P.clone()]}else{var T;(T=P.clone()).lerp(A,.5);k=[P.clone(),C.clone(),T.clone()],_=[T.clone(),C.clone(),A.clone()]}r[E].push(k,_)}}else{n.push(s);for(E=0,M=e.faceVertexUvs.length;E<M;E++)r[E].push(e.faceVertexUvs[E][i])}}}e.faces=n,e.faceVertexUvs=r};var m=function(e){this.subdivisions=void 0===e?1:e};m.prototype.modify=function(e){for(var t=this.subdivisions;t-- >0;)this.smooth(e);e.computeFaceNormals(),e.computeVertexNormals()},function(){var e=["a","b","c"];function t(e,t,n){return n[Math.min(e,t)+"_"+Math.max(e,t)]}function n(e,t,n,r,o,i){var a,s=Math.min(e,t),c=Math.max(e,t),u=s+"_"+c;u in r?a=r[u]:(a={a:n[s],b:n[c],newEdge:null,faces:[]},r[u]=a);a.faces.push(o),i[e].edges.push(a),i[t].edges.push(a)}function r(e,t,n,r){e.push(new h.Face3(t,n,r))}function o(e,t){return Math.abs(t-e)/2+Math.min(e,t)}function i(e,t,n,r){e.push([t.clone(),n.clone(),r.clone()])}m.prototype.smooth=function(a){var s,c,u,l,f,p,d,v,m,y,g,b,w,x,S=new h.Vector3,O=[];s=a.vertices,c=a.faces;var E,M,j,P,C,A,k,_,T,L,N,G,I,R,F=void 0!==(u=a.faceVertexUvs[0])&&u.length>0;for(d in function(e,t,r,o){var i,a,s;for(i=0,a=e.length;i<a;i++)r[i]={edges:[]};for(i=0,a=t.length;i<a;i++)n((s=t[i]).a,s.b,e,o,s,r),n(s.b,s.c,e,o,s,r),n(s.c,s.a,e,o,s,r)}(s,c,g=new Array(s.length),b={}),w=[],b){for(M=b[d],j=new h.Vector3,C=3/8,A=1/8,2!=(k=M.faces.length)&&(C=.5,A=0),j.addVectors(M.a,M.b).multiplyScalar(C),S.set(0,0,0),m=0;m<k;m++){for(P=M.faces[m],y=0;y<3&&((E=s[P[e[y]]])===M.a||E===M.b);y++);S.add(E)}S.multiplyScalar(A),j.add(S),M.newEdge=w.length,w.push(j)}for(x=[],d=0,v=s.length;d<v;d++){for(I=s[d],3==(p=(G=g[d].edges).length)?_=3/16:p>3&&(_=3/(8*p)),T=1-p*_,L=_,p<=2&&2==p&&(T=3/4,L=1/8),R=I.clone().multiplyScalar(T),S.set(0,0,0),m=0;m<p;m++)E=(N=G[m]).a!==I?N.a:N.b,S.add(E);S.multiplyScalar(L),R.add(S),x.push(R)}l=x.concat(w);var U,V,D,z,H,Y,W,Z=x.length;f=[];var q=new h.Vector2,B=new h.Vector2,X=new h.Vector2;for(d=0,v=c.length;d<v;d++)r(f,U=t((P=c[d]).a,P.b,b).newEdge+Z,V=t(P.b,P.c,b).newEdge+Z,D=t(P.c,P.a,b).newEdge+Z),r(f,P.a,U,D),r(f,P.b,V,U),r(f,P.c,D,V),F&&(H=(z=u[d])[0],Y=z[1],W=z[2],q.set(o(H.x,Y.x),o(H.y,Y.y)),B.set(o(Y.x,W.x),o(Y.y,W.y)),X.set(o(H.x,W.x),o(H.y,W.y)),i(O,q,B,X),i(O,H,q,X),i(O,Y,B,q),i(O,W,X,B));a.vertices=l,a.faces=f,F&&(a.faceVertexUvs[0]=O)}}();var y=function(){function e(t){var n=t.scene,r=t.json,o=t.radius;a()(this,e),this.lineGroup=new h.Group,this.shapeGroup=new h.Group,this.scene=n||window.scene,this.radius=o,this.json_geom=this.createGeometryArray(r),this.x_values=[],this.y_values=[],this.z_values=[],this.x_plane_values=[],this.y_plane_values=[],this.z_plane_values=[]}return c()(e,[{key:"init",value:function(e){var t=e.line,n=void 0!==t&&t,r=e.lineOptions,o=void 0===r?{}:r,i=e.shape,a=void 0!==i&&i,s=e.shapeOptions,c=void 0===s?{}:s;this.lineGroup.name="lineGroup",this.shapeGroup.name="shapeGroup";this.options;var u=this.radius,l=this.json_geom,f=[],p=(c||{}).materOptions;p&&Object.keys(p).length||(p={color:5126815,opacity:0,transparent:!0});for(var d=c&&c.material||new h.MeshLambertMaterial(p),v=new h.Geometry,m=0;m<l.length;m++){var y=l[m]||{},g=y.coordinates,b=void 0===g?[]:g,w=y.type,x=y.properties;if("Polygon"===w)for(var S=0;S<b.length;S++){f=this.createCoordinateArray(b[S]);for(var O=0;O<f.length;O++)n&&this.convertToCoords(f[O],u),a&&this.convertToPlaneCoords(f[O],u);if(n){var E=this.x_values,M=void 0===E?[]:E,j=this.y_values,P=void 0===j?[]:j,C=this.z_values,A=void 0===C?[]:C;this.drawLine(M,P,A,o)}if(a){var k=this.x_plane_values,_=void 0===k?[]:k,T=this.y_plane_values,L=void 0===T?[]:T,N=this.z_plane_values,G=void 0===N?[]:N;this.drawShape(_,L,G,c,d,x,u)}}else if("MultiPolygon"===w){this.mergeGeo=v.clone();for(var I=0;I<b.length;I++)for(var R=0;R<b[I].length;R++){f=this.createCoordinateArray(b[I][R]);for(var F=0;F<f.length;F++)n&&this.convertToCoords(f[F],u),a&&this.convertToPlaneCoords(f[F],u);if(n){var U=this.x_values,V=void 0===U?[]:U,D=this.y_values,z=void 0===D?[]:D,H=this.z_values,Y=void 0===H?[]:H;this.drawLine(V,z,Y,o)}if(a){var W=this.x_plane_values,Z=void 0===W?[]:W,q=this.y_plane_values,B=void 0===q?[]:q,X=this.z_plane_values,K=void 0===X?[]:X;this.drawShape(Z,B,K,c,d,x,u,"multiple")}}var J=new h.Mesh(this.mergeGeo,d.clone());this.shapeGroup.add(J)}}return this.lineGroup&&this.lineGroup.children&&this.lineGroup.children.length&&this.scene.add(this.lineGroup),this.shapeGroup&&this.shapeGroup.children&&this.shapeGroup.children.length&&this.scene.add(this.shapeGroup),{lineGroup:this.lineGroup,shapeGroup:this.shapeGroup}}},{key:"createGeometryArray",value:function(e){var t=e||{},n=t.type,r=t.features,o=void 0===r?[]:r,i=t.geometries,a=void 0===i?[]:i,s=[];if("Feature"==n)s.push(a);else if("FeatureCollection"==n)for(var c=0;c<o.length;c++){var u=o[c],l=u.geometry;l.properties=u.properties,s.push(l)}else{if("GeometryCollection"!=n)throw new Error("The geoJSON is not valid.");for(var h=0;h<a.length;h++)s.push(a[h])}return s}},{key:"convertToPlaneCoords",value:function(e,t){var n=e[0],r=e[1];this.x_plane_values.push(n/180*t),this.y_plane_values.push(r/180*t)}},{key:"convertToCoords",value:function(e,t){var n=(180+e[0])*(Math.PI/180),r=(90-e[1])*(Math.PI/180),o=-t*Math.sin(r)*Math.cos(n),i=t*Math.cos(r),a=t*Math.sin(r)*Math.sin(n);this.x_values.push(o),this.y_values.push(i),this.z_values.push(a)}},{key:"drawLine",value:function(e,t,n,r){for(var o=new h.Geometry,i=0;i<e.length;i++)o.vertices.push(new h.Vector3(e[i],t[i],n[i]));var a=new h.LineBasicMaterial(r||{color:"white",opacity:.2,transparent:!0}),s=new h.Line(o,a);this.lineGroup.add(s),this.clearVerArrays()}},{key:"drawShape",value:function(e,t,n,r,o,i,a,s){var c=this.drawShapeGeo(e,t,n,r);if(r.isSubdivision)(u=new m(1)).modify(c);else for(var u=new v(3),l=0;l<12;l++)u.modify(c);this.planeToSpr(c,i,a);var f=new h.Mesh(c,o.clone());f.properties=i,s?this.mergeGeo.merge(f.geometry,f.matrix):this.shapeGroup.add(f)}},{key:"drawShapeGeo",value:function(e,t,n,r){var o=new h.Shape;o.moveTo(e[0],t[0]);for(var i=1;i<e.length;i++)o.lineTo(e[i],t[i]);return this.clearPlaneArrays(),new h.ShapeGeometry(o)}},{key:"planeToSpr",value:function(e,t,n){for(var r=e.vertices,o=0;o<r.length;o++){var i=n,a=r[o].y/i*Math.PI,s=-r[o].x/i*Math.PI;r[o].x=Math.cos(a)*Math.cos(s)*i,r[o].z=Math.cos(a)*Math.sin(s)*i,r[o].y=Math.sin(a)*i}}},{key:"clearVerArrays",value:function(){this.x_values=[],this.y_values=[],this.z_values=[]}},{key:"clearPlaneArrays",value:function(){this.x_plane_values=[],this.y_plane_values=[],this.z_plane_values=[]}},{key:"createCoordinateArray",value:function(e){for(var t=e,n=[],r=[],o=0;o<t.length;o++){var i=t[o],a=t[o-1];if(o>0)if(this.needsInterpolation(a,i)){r=[a,i],r=this.interpolatePoints(r);for(var s=0;s<r.length;s++)n.push(r[s])}else n.push(i);else n.push(i)}return n}},{key:"needsInterpolation",value:function(e,t){var n=t[0],r=t[1],o=e[0],i=e[1],a=Math.abs(n-o),s=Math.abs(r-i);return a>5||s>5}},{key:"interpolatePoints",value:function(e){for(var t,n,r=[],o=0;o<e.length-1;o++)t=e[o],n=e[o+1],this.needsInterpolation(n,t)?(r.push(t),r.push(this.getMidpoint(t,n))):r.push(t);return r.push(e[e.length-1]),r.length>e.length?r=this.interpolatePoints(r):r}},{key:"getMidpoint",value:function(e,t){return[(e[0]+t[0])/2,(e[1]+t[1])/2]}}]),e}(),g=n(8),b=n.n(g),w=n(9),x=n.n(w);function S(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(){function e(t){var n=t.radius,r=t.pointsData;a()(this,e),this.radius=n,this.pointsData=r}return c()(e,[{key:"columnar",value:function(){var e,t=this.radius,n=this.pointsData,r=new h.Group,o=new h.CylinderGeometry(2,2,parseInt(100*Math.random()),8),i=S(n.entries());try{for(i.s();!(e=i.n()).done;){var a=x()(e.value,2),s=a[0],c=a[1],u=o.clone(),l=new h.Matrix4;l.makeRotationX(-Math.PI/2),l.setPosition(new h.Vector3(0,0,-5)),u.applyMatrix(l);var f=new h.Mesh(u,new h.MeshBasicMaterial({color:c.color,transparent:!0,side:h.DoubleSide}));f.position.copy(d.apply(void 0,b()(c.position).concat([t]))),f.lookAt(new h.Vector3(0,0,0)),f.name=s,r.add(f)}}catch(e){i.e(e)}finally{i.f()}return r}}]),e}(),M={uniforms:{texture:{type:"t",value:null}},vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","void main() {","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","vNormal = normalize( normalMatrix * normal );","vUv = uv;","}"].join("\n"),fragmentShader:["uniform sampler2D texture;","varying vec3 vNormal;","varying vec2 vUv;","void main() {","vec3 diffuse = texture2D( texture, vUv ).xyz;","float intensity = 1.2 - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) );","vec3 atmosphere = vec3( 1.0, 1.0, 1.0 ) * pow( intensity, 3.0 );","gl_FragColor = vec4( diffuse + atmosphere, 1.0 );","}"].join("\n")};function j(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return P(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return P(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,o,i=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==r.return||r.return()}finally{if(a)throw o}}}}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var A=function(){function e(t,n){a()(this,e),this.set=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({radius:142,width:window.innerWidth,height:window.innerHeight},n),this.shapeGroup=null,this.lineGroup=null,this.map=l.a.decode(t)}return c()(e,[{key:"init",value:function(){var e=this.set||{},t=e.radius,n=e.needHelp,r=e.point,o=e.countryEdge,i=e.flyLine,a=e.countryShape;if(this.rayCaster=new h.Raycaster,this.mouse=new h.Vector2,this.interSelected=null,this.scene=new h.Scene,this.scene.background="#333",this.container=this.set.container||document.getElementById("App"),this.setCamera({x:-150,y:300,z:-400}),this.setLight(),this.setRender(),this.setControl(),this.createGlobal(),n&&this.setHelper(),o||a){var s=new y({json:this.map,radius:t+2,scene:this.scene}).init({line:o,lineOptions:{color:"white",opacity:.16,transparent:!0},shape:a,shapeOptions:{}}),c=s.shapeGroup,u=s.lineGroup;o&&(this.shapeGroup=c),a&&(this.lineGroup=u,window.addEventListener("mousemove",this.onMouseMove.bind(this),!1))}if(r){var l=r||{},p=l.pointsData,v=l.column,m=l.wave;if(v){var g=new E({radius:t,pointsData:p});this.columnarPointGroup=g.columnar(),this.scene.add(this.columnarPointGroup)}if(m){this.sphereWave=new f.SphereWave({radius:t+1,speed:.05,minOpacity:.1}),this.scene.add(this.sphereWave);var b,w=[],x=j(p);try{for(x.s();!(b=x.n()).done;){var S=b.value;w.push({position:d(S.position[0],S.position[1],t+1),height:50*Math.random(),color:"rgb(".concat(Math.floor(255*Math.random()),",").concat(Math.floor(255*Math.random()),",").concat(Math.floor(255*Math.random()),")")})}}catch(e){x.e(e)}finally{x.f()}this.sphereWave.setData(w)}}if(i){this.flySphereLine=new f.FlyLine({addLineTimeout:100,curveType:"2bezier",length:50,radius:t,materialConfig:{startColor:new h.Vector4(1,0,1,0),endColor:new h.Vector4(0,0,1,1)}}),this.scene.add(this.flySphereLine);var O=[],M=(i||{}).lineData;if(M){var P,C=j(M);try{for(C.s();!(P=C.n()).done;){var A=P.value;O.push({start:d(A[0][0],A[0][1],t),end:d(A[1][0],A[1][1],t)})}}catch(e){C.e(e)}finally{C.f()}}this.flySphereLine.setData(O),this.flySphereLine.start(),this.activeMesh=this.flySphereLine}return this.animate(),window.addEventListener("resize",this.windowResize.bind(this),!1),this}},{key:"setCamera",value:function(e){this.camera=new h.PerspectiveCamera(45,this.set.width/this.set.height,.1,1280);var t=e.x,n=e.y,r=e.z;this.camera.position.set(t,n,r),this.camera.lookAt(0,0,0),this.scene.add(this.camera)}},{key:"setLight",value:function(){var e=new h.AmbientLight(4210752),t=new h.DirectionalLight(16777215);t.position.set(60,60,60),t.distance=100,t.intensity=1.5,this.scene.add(e),this.scene.add(t)}},{key:"setRender",value:function(){this.renderer=new h.WebGLRenderer({antialias:!0,alpha:!1}),this.renderer.shadowMap.enabled=!0,this.renderer.setSize(this.set.width,this.set.height),this.container.appendChild(this.renderer.domElement)}},{key:"setControl",value:function(){var e=this,t=(this.set||{}).control;this.controls=new p(this.camera,this.container),this.controls.update(),t&&Object.keys(t).length>0&&Object.keys(t).map((function(n){t[n]&&(e.controls[n]=t[n])}))}},{key:"setHelper",value:function(){var e=new h.AxesHelper(300);this.scene.add(e)}},{key:"createGlobal",value:function(){var e=this.set||{},t=e.radius,n=e.mapImg,r=e.transparent;this.geometry=new h.SphereGeometry(t,50,50);var o=h.UniformsUtils.clone(M.uniforms);this.mapTexture=(new h.TextureLoader).load(n),o.texture.value=this.mapTexture,this.earthMaterial=new h.ShaderMaterial({uniforms:o,vertexShader:M.vertexShader,fragmentShader:M.fragmentShader,blending:h.NormalBlending,depthWrite:!r}),this.meshEarth=new h.Mesh(this.geometry,this.earthMaterial),this.scene.add(this.meshEarth)}},{key:"animate",value:function(){this.requestAnimation=requestAnimationFrame(this.animate.bind(this)),this.activeMesh&&this.activeMesh.update&&this.activeMesh.update(),this.sphereWave&&this.sphereWave.update&&this.sphereWave.update(),this.set.cb&&"function"==typeof this.setcb&&this.set.cb(),this.controls.update(),this.renderer.render(this.scene,this.camera)}},{key:"windowResize",value:function(){console.log(this.set.width,this.set.height);var e=this.set.width||window.innerWidth,t=this.set.height||window.innerHeight;this.renderer.setSize(e,t),this.camera.aspect=e/t,this.camera.updateProjectionMatrix()}},{key:"onMouseMove",value:function(e){var t=this.container.getBoundingClientRect()||{},n=t.top,r=t.left;this.mouse.x=(event.clientX-(r||0))/this.set.width*2-1,this.mouse.y=-(event.clientY-(n||0))/this.set.height*2+1,this.shapeHover()}},{key:"shapeHover",value:function(){this.rayCaster.setFromCamera(this.mouse,this.camera);var e=this.rayCaster.intersectObjects(this.shapeGroup.children);if(e.length>0){var t=e[0].object.material;if(!t||!t.emissive)return;this.interSelected&&(this.interSelected.material.opacity=0),this.interSelected=e[0].object,this.interSelected.material.color.set(3169471),this.interSelected.material.opacity=.5}else this.interSelected&&(this.interSelected.material.opacity=0),this.interSelected=null}},{key:"disposeGroup",value:function(e){e.traverse((function(e){"Mesh"===e.type&&(e.geometry.dispose(),e.material.dispose())})),this.scene.remove(e)}},{key:"dispose",value:function(){cancelAnimationFrame(this.requestAnimation),this.requestAnimation=null,this.shapeGroup&&this.disposeGroup(this.shapeGroup),this.lineGroup&&this.disposeGroup(this.lineGroup),this.columnarPointGroup&&this.disposeGroup(this.columnarPointGroup),this.sphereWave&&this.sphereWave.dispose(),this.flySphereLine&&this.flySphereLine.dispose(),this.onMouseMove&&window.removeEventListener("mousemove",this.onMouseMove.bind(this)),window.removeEventListener("resize",this.windowResize.bind(this)),this.meshEarth&&(this.meshEarth.geometry.dispose(),this.meshEarth.material.dispose(),this.scene.remove(this.meshEarth)),this.scene.dispose(),this.controls.dispose();var e=this.renderer.domElement.getContext("webgl");e&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext()}}]),e}()}])}));